<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="/static/css/shop.css" type="text/css" rel="stylesheet" />
<link href="/static/css/Sellerber.css" type="text/css"  rel="stylesheet" />
<link href="/static/css/bkg_ui.css" type="text/css"  rel="stylesheet" />
<link href="/static/font/css/font-awesome.min.css"  rel="stylesheet" type="text/css" />
<script src="/static/js/jquery-1.9.1.min.js" type="text/javascript" ></script>
<script src="/static/js/layer/layer.js" type="text/javascript"></script>
    <script src="/static/js/Sellerber.js" type="text/javascript"></script>
<title>个人信息</title>
</head>
<body>
<div class="margin" id="page_style">
   <div class="personal_info">
   <div class="add_style clearfix border_style">
   <form id="user_info" method="post" enctype="multipart/form-data">
       <input type="hidden" value="{$my.ad_id}" name="ad_id"/>
       <input type="hidden" value="{$my.da_id}" name="da_id"/>
    <div class="clearfix">
        <div class="form-group clearfix col-xs-3">
        <label class="col-xs-3 label_name" for="form-field-1">用户名：</label>
         <div class="col-xs-9 line_height1">
             <input type="text" name="ad_name" data-name="用户名" id="username" value="{$my.ad_name}" class="col-xs-7 text_info" disabled="disabled">
         </div>
          </div>
              <div class="form-group clearfix col-xs-3">
        <label class="col-xs-3 label_name" for="form-field-1">真实姓名：</label>
         <div class="col-xs-9 line_height1"><input type="text" name="da_name" data-name="真实姓名" id="surname" value="{$my.da_name}" class="col-xs-7 text_info" disabled="disabled"></div>
          </div>
          <div class="form-group clearfix col-xs-3"><label class="col-xs-3 label_name" for="form-field-1">性别： </label>
          <div class="col-xs-9 line_height1">
          <span class="sex">{$my.da_sex}</span>
            <div class="add_sex">
            <label>
                <input name="da_sex" type="radio"  class="ace" value="保密" {:$my.da_sex="保密"?'checked':''}>
                <span class="lbl">保密</span>
            </label>&nbsp;&nbsp;
            <label>
                <input name="da_sex" type="radio" class="ace" value="男" {:$my.da_sex="男"?'checked':''}>
                <span class="lbl">男</span>
            </label>&nbsp;&nbsp;
            <label>
                <input name="da_sex" type="radio" class="ace" value="女" {:$my.da_sex="女"?'checked':''}>
                <span class="lbl">女</span>
            </label>
            </div>
           </div>
          </div>
          <div class="form-group clearfix col-xs-3"><label class="col-xs-3 label_name" for="form-field-1">年龄： </label>
          <div class="col-xs-9 line_height1">
              <input type="text" name="da_age" data-name="年龄" id="age" value="{$my.da_age}" class="col-xs-7 text_info" disabled="disabled">
          </div>
          </div>

           <div class="form-group clearfix col-xs-3"><label class="col-xs-3 label_name" for="form-field-1">权限： </label>
          <div class="col-xs-9 line_height1"> <span>{$my.pow_name}</span></div>
          </div>
           <div class="form-group clearfix col-xs-3">
               <label class="col-xs-3 label_name" for="form-field-1">注册时间： </label>
          <div class="col-xs-9 line_height1">
              <span>{$my.da_time}</span>
          </div>
          </div>
        <div class="form-group clearfix col-xs-3" style="position: relative"><label class="col-xs-3 label_name" for="form-field-1">头像： </label>
            <div class="col-xs-9 line_height1">
                <input type="file" name="da_head" data-name="头像" value="{$head}" class="col-xs-7 text_info" disabled="disabled" id="images" required="required">
                <img src="{$head}" class="img1 fr hidden" alt="您还没有头像" style="width: 70px;height: 70px;position: absolute;left: 50%">
            </div>
        </div>
          </div>
   </form>
           <div class="Button_operation clearfix"> 
                <input type="button" id="modify" class="btn btn-danger operation_btn"  value="修改信息"/>
                <button type="button" id="change_Password" class="btn bg-green operation_btn">修改密码</button>
                <input type="button" id="save_info" class="btn bg-deep-blue operation_btn save"  value="保存修改"/>
			</div>
            </div><div id="text_name"></div>
   </div>
   <!--操作记录-->
   <div class="admin_recording clearfix">
      <div class="searchs  clearfix  operation">
 <label class="label_name">记录搜索：</label>
 <input class="inline laydate-icon " id="start" type="text"  style=" margin-right:10px; height:auto; float:left; width:150px;" />
 <input name="" type="text"  class="form-control col-xs-1" style=" width:250px"/><button class="btn button_btn bg-deep-blue " onclick=""  type="button"><i class="fa  fa-search"></i>&nbsp;搜索</button>

</div>
        <table id="sample_table" class="table table_list table_striped table-bordered dataTable no-footer">
           <thead>
			<tr>
              <th  width="80px">排序</th>
			  <th>内容</th>
			  <th width="150px">操作时间</th>
              <th width="300px">备注</th>       
             </tr>
		    </thead>
            <tbody>
             <tr><td>1</td><td>添加了10个商品信息</td><td>2016-9-29 12:23</td><td>一个未保存成功</td></tr>
            </tbody>
         </table>   
   </div>
</div>
 <!--修改密码样式-->
         <div class="change_Pass_style display" id="change_Pass">
             <form id="change_form">
            <ul class="change_Password clearfix">
             <li>
             <label class="label_name">
                 原&nbsp;&nbsp;密&nbsp;码
             </label>
                 <span class="change_text">
                     <input name="pass" data-name="原密码" type="password"  id="password">
                 </span>
             </li>
             <li>
             <label class="label_name">
                 新&nbsp;&nbsp;密&nbsp;码
             </label>
                 <span class="change_text">
                     <input name="Npass"  data-name="新密码" type="password"  id="Nes_pas">
                 </span>
             </li>
             <li>
             <label class="label_name">
                 确认密码
             </label>
                 <span class="change_text">
                     <input name="Npass2" type="password" data-name="再次确认密码" id="c_mew_pas">
                 </span>
             </li>
            </ul>
             </form>
         </div>
</body>
<script>
    $(document).ready(function(){
        $('#change_Password').click(function(){
            change_Password();
        });
        $('#modify').click(function () {
            modify();
        })
    });
    /**预览图片***/
    $('#images').on("change",function(){
        var srcs = getObjectURL(this.files[0]);
        $('.img1').attr("src",srcs).attr('layer-src',srcs);
        $('.img_look').hide().next('.img1').show();
    });
    /**获取图片地址**/
    function getObjectURL(file) {
        var url = null;
        if (window.createObjectURL != undefined) {
            url = window.createObjectURL(file)
        } else if (window.URL != undefined) {
            url = window.URL.createObjectURL(file)
        } else if (window.webkitURL != undefined) {
            url = window.webkitURL.createObjectURL(file)
        }
        return url
    }
    /****修改密码****/
    function change_Password(){
        layer.open({
            type: 1,
            title:'修改密码',
            area: ['300px','300px'],
            content: $('#change_Pass'),
            btn:['确认修改'],
            yes:function(index, layero){
                var num=0;
                var str="";
                var $paddword=/^[a-z0-9_-]{5,18}$/;

                $("input[type$='password']").each(function(n){
                    if($(this).val()=="")
                    {

                        layer.alert(str+=""+$(this).attr("data-name")+"不能为空！\r\n",{
                            title: '提示框',
                            icon:0,
                        });
                        num++;
                        return false;
                    }
                });
                if(num>0){  return false;}
                if(!$("#c_mew_pas").val || $("#c_mew_pas").val() != $("#Nes_pas").val() )
                {
                    layer.alert('密码不一致!',{
                        title: '提示框',
                        icon:0,

                    });
                    return false;
                }
                else{
                    var params = new FormData($('#change_form')[0]);
                    $.ajax({
                        type:"post",
                        url:"Htm/pass",
                        dataType:"text",
                        data:params,
                        async : true,
                        cache : false,
                        contentType : false,
                        processData : false,
                        success:function (msg) {
                            if(msg===1100){
                                layer.alert('修改成功！',{
                                    title: '提示框',
                                    icon :1,
                                    yes  : function () {
                                        location.assign(location);
                                    }
                                });
                            }else {
                                layer.alert('修改失败！'+msg,{
                                    title: '提示框',
                                    icon :2
                                });
                            }
                        },error:function () {
                            layer.alert('出错了！'+msg,{
                                title: '提示框',
                                icon :2
                            });
                        }
                    });
                    layer.close(index);
                }
            }
        });
    }
    /*******滚动条*******/
    $("body").niceScroll({
        cursorcolor:"#888888",
        cursoropacitymax:1,
        touchbehavior:false,
        cursorwidth:"5px",
        cursorborder:"0",
        cursorborderradius:"5px"
    });
    /********个人信息操作*******/
    function modify(){
        $('.text_info').attr("disabled", false);
        $('.text_info').addClass("add");
        $('#page_style').find('.add_style').addClass("hover");
        $('#page_style').find('.save').css({'display':'block'});
    };
    $("#save_info").click(function(){
        var num=0;
        var params=new FormData($('#user_info')[0]);
        $(".xinxi input[type$='text']").each(function(n){
            if($(this).val()=="")
            {
                layer.alert(str+=""+$(this).attr("name")+"不能为空！\r\n",{
                    title: '提示框',
                    icon:0,
                });
                num++;
                return false;
            }
        });
        if(num>0){  return false;}
        else{
            $.ajax({
                type : "post",
                url  : "{:request()->domain()}/admin/Htm/change",
                dataType:"text",
                data : params,
                async : true,
                cache : false,
                contentType : false,
                processData : false,
                success : function (msg) {
                    if(msg==1100){
                        layer.alert('修改成功！',{
                            title: '提示框',
                            icon:1,
                            yes : function () {
                                location.assign(location);
                            }
                        });
                    }else {
                        layer.alert(msg,{
                            title: '提示框',
                            icon:2
                        })
                    }

                },
                error   : function (msg) {
                    layer.alert('出错了！'+msg,{
                        title: '提示框',
                        icon:0
                    });
                }
            });
            layer.close();
        }
    });
</script>
</html>

